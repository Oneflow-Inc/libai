[09/23 08:07:21] libai INFO: Rank of current process: 0. World size: 1
[09/23 08:07:21] libai INFO: Command line arguments: Namespace(config_file='configs/config.py', eval_only=False, fast_dev_run=False, opts=[], resume=False)
[09/23 08:07:22] libai INFO: Contents of args.config_file=configs/config.py:
[38;5;197mimport[39m[38;5;15m [39m[38;5;15msys[39m[38;5;197m,[39m[38;5;15m [39m[38;5;15mos[39m
[38;5;15mdir_path[39m[38;5;15m [39m[38;5;197m=[39m[38;5;15m [39m[38;5;15mos[39m[38;5;197m.[39m[38;5;15mpath[39m[38;5;197m.[39m[38;5;15mabspath[39m[38;5;15m([39m[38;5;15mos[39m[38;5;197m.[39m[38;5;15mpath[39m[38;5;197m.[39m[38;5;15mdirname[39m[38;5;15m([39m[38;5;15m__file__[39m[38;5;15m)[39m[38;5;15m)[39m
[38;5;15mdir_path[39m[38;5;15m [39m[38;5;197m=[39m[38;5;15m [39m[38;5;186m"[39m[38;5;186m/[39m[38;5;186m"[39m[38;5;197m.[39m[38;5;15mjoin[39m[38;5;15m([39m[38;5;15mdir_path[39m[38;5;197m.[39m[38;5;15msplit[39m[38;5;15m([39m[38;5;186m"[39m[38;5;186m/[39m[38;5;186m"[39m[38;5;15m)[39m[38;5;15m[[39m[38;5;15m:[39m[38;5;197m-[39m[38;5;141m1[39m[38;5;15m][39m[38;5;15m)[39m
[38;5;15mprint[39m[38;5;15m([39m[38;5;15mdir_path[39m[38;5;15m)[39m
[38;5;15msys[39m[38;5;197m.[39m[38;5;15mpath[39m[38;5;197m.[39m[38;5;15mappend[39m[38;5;15m([39m[38;5;15mdir_path[39m[38;5;15m)[39m

[38;5;197mfrom[39m[38;5;15m [39m[38;5;15momegaconf[39m[38;5;15m [39m[38;5;197mimport[39m[38;5;15m [39m[38;5;15mOmegaConf[39m

[38;5;197mfrom[39m[38;5;15m [39m[38;5;15mlibai[39m[38;5;15m.[39m[38;5;15mconfig[39m[38;5;15m [39m[38;5;197mimport[39m[38;5;15m [39m[38;5;15mget_config[39m
[38;5;197mfrom[39m[38;5;15m [39m[38;5;15mlibai[39m[38;5;15m.[39m[38;5;15mconfig[39m[38;5;15m [39m[38;5;197mimport[39m[38;5;15m [39m[38;5;15mLazyCall[39m
[38;5;197mfrom[39m[38;5;15m [39m[38;5;15mlibai[39m[38;5;15m.[39m[38;5;15mdata[39m[38;5;15m.[39m[38;5;15mbuild[39m[38;5;15m [39m[38;5;197mimport[39m[38;5;15m [39m[38;5;15mbuild_nlp_train_loader[39m[38;5;15m,[39m[38;5;15m [39m[38;5;15mbuild_nlp_test_loader[39m

[38;5;197mfrom[39m[38;5;15m [39m[38;5;15mdataset[39m[38;5;15m.[39m[38;5;15mdataset[39m[38;5;15m [39m[38;5;197mimport[39m[38;5;15m [39m[38;5;15mCoupletsDataset[39m
[38;5;197mfrom[39m[38;5;15m [39m[38;5;15mmodeling[39m[38;5;15m.[39m[38;5;15mmodel[39m[38;5;15m [39m[38;5;197mimport[39m[38;5;15m [39m[38;5;15mSeq2Seq[39m

[38;5;15moptim[39m[38;5;15m [39m[38;5;197m=[39m[38;5;15m [39m[38;5;15mget_config[39m[38;5;15m([39m[38;5;186m"[39m[38;5;186mcommon/optim.py[39m[38;5;186m"[39m[38;5;15m)[39m[38;5;197m.[39m[38;5;15moptim[39m
[38;5;15mgraph[39m[38;5;15m [39m[38;5;197m=[39m[38;5;15m [39m[38;5;15mget_config[39m[38;5;15m([39m[38;5;186m"[39m[38;5;186mcommon/models/graph.py[39m[38;5;186m"[39m[38;5;15m)[39m[38;5;197m.[39m[38;5;15mgraph[39m
[38;5;15mtrain[39m[38;5;15m [39m[38;5;197m=[39m[38;5;15m [39m[38;5;15mget_config[39m[38;5;15m([39m[38;5;186m"[39m[38;5;186mcommon/train.py[39m[38;5;186m"[39m[38;5;15m)[39m[38;5;197m.[39m[38;5;15mtrain[39m

[38;5;15mdataloader[39m[38;5;15m [39m[38;5;197m=[39m[38;5;15m [39m[38;5;15mOmegaConf[39m[38;5;197m.[39m[38;5;15mcreate[39m[38;5;15m([39m[38;5;15m)[39m
[38;5;15mdataloader[39m[38;5;197m.[39m[38;5;15mtrain[39m[38;5;15m [39m[38;5;197m=[39m[38;5;15m [39m[38;5;15mLazyCall[39m[38;5;15m([39m[38;5;15mbuild_nlp_train_loader[39m[38;5;15m)[39m[38;5;15m([39m
[38;5;15m    [39m[38;5;15mdataset[39m[38;5;197m=[39m[38;5;15m[[39m
[38;5;15m        [39m[38;5;15mLazyCall[39m[38;5;15m([39m[38;5;15mCoupletsDataset[39m[38;5;15m)[39m[38;5;15m([39m
[38;5;15m            [39m[38;5;15mpath[39m[38;5;197m=[39m[38;5;186m"[39m[38;5;186m/dataset/1564ee80/v3/couplets[39m[38;5;186m"[39m[38;5;15m,[39m
[38;5;15m            [39m[38;5;15mis_train[39m[38;5;197m=[39m[38;5;81mTrue[39m[38;5;15m,[39m
[38;5;15m            [39m[38;5;15mmaxlen[39m[38;5;197m=[39m[38;5;141m64[39m[38;5;15m,[39m
[38;5;15m        [39m[38;5;15m)[39m
[38;5;15m    [39m[38;5;15m][39m[38;5;15m,[39m
[38;5;15m    [39m[38;5;15mnum_workers[39m[38;5;197m=[39m[38;5;141m4[39m[38;5;15m,[39m
[38;5;15m)[39m
[38;5;15mdataloader[39m[38;5;197m.[39m[38;5;15mtest[39m[38;5;15m [39m[38;5;197m=[39m[38;5;15m [39m[38;5;15m[[39m
[38;5;15m    [39m[38;5;15mLazyCall[39m[38;5;15m([39m[38;5;15mbuild_nlp_test_loader[39m[38;5;15m)[39m[38;5;15m([39m
[38;5;15m        [39m[38;5;15mdataset[39m[38;5;197m=[39m[38;5;15mLazyCall[39m[38;5;15m([39m[38;5;15mCoupletsDataset[39m[38;5;15m)[39m[38;5;15m([39m
[38;5;15m            [39m[38;5;15mpath[39m[38;5;197m=[39m[38;5;186m"[39m[38;5;186m/dataset/1564ee80/v3/couplets[39m[38;5;186m"[39m[38;5;15m,[39m
[38;5;15m            [39m[38;5;15mis_train[39m[38;5;197m=[39m[38;5;81mFalse[39m[38;5;15m,[39m
[38;5;15m            [39m[38;5;15mmaxlen[39m[38;5;197m=[39m[38;5;141m64[39m[38;5;15m,[39m
[38;5;15m        [39m[38;5;15m)[39m[38;5;15m,[39m
[38;5;15m        [39m[38;5;15mnum_workers[39m[38;5;197m=[39m[38;5;141m4[39m[38;5;15m,[39m
[38;5;15m    [39m[38;5;15m)[39m
[38;5;15m][39m

[38;5;15mtransformer_cfg[39m[38;5;15m [39m[38;5;197m=[39m[38;5;15m [39m[38;5;15mdict[39m[38;5;15m([39m
[38;5;15m    [39m[38;5;15mvocab_size[39m[38;5;197m=[39m[38;5;141m9027[39m[38;5;15m,[39m
[38;5;15m    [39m[38;5;15mmax_position_embeddings[39m[38;5;197m=[39m[38;5;141m64[39m[38;5;15m,[39m
[38;5;15m    [39m[38;5;15mhidden_size[39m[38;5;197m=[39m[38;5;141m512[39m[38;5;15m,[39m
[38;5;15m    [39m[38;5;15mintermediate_size[39m[38;5;197m=[39m[38;5;141m512[39m[38;5;15m,[39m
[38;5;15m    [39m[38;5;15mhidden_layers[39m[38;5;197m=[39m[38;5;141m6[39m[38;5;15m,[39m
[38;5;15m    [39m[38;5;15mnum_attention_heads[39m[38;5;197m=[39m[38;5;141m8[39m[38;5;15m,[39m
[38;5;15m    [39m[38;5;15membedding_dropout_prob[39m[38;5;197m=[39m[38;5;141m0.1[39m[38;5;15m,[39m
[38;5;15m    [39m[38;5;15mhidden_dropout_prob[39m[38;5;197m=[39m[38;5;141m0.1[39m[38;5;15m,[39m
[38;5;15m    [39m[38;5;15mattention_dropout_prob[39m[38;5;197m=[39m[38;5;141m0.1[39m[38;5;15m,[39m
[38;5;15m    [39m[38;5;15minitializer_range[39m[38;5;197m=[39m[38;5;141m0.02[39m[38;5;15m,[39m
[38;5;15m    [39m[38;5;15mlayernorm_epsilon[39m[38;5;197m=[39m[38;5;141m1e-5[39m[38;5;15m,[39m
[38;5;15m    [39m[38;5;15mbias_gelu_fusion[39m[38;5;197m=[39m[38;5;81mFalse[39m[38;5;15m,[39m
[38;5;15m    [39m[38;5;15mbias_dropout_fusion[39m[38;5;197m=[39m[38;5;81mFalse[39m[38;5;15m,[39m
[38;5;15m    [39m[38;5;15mscale_mask_softmax_fusion[39m[38;5;197m=[39m[38;5;81mFalse[39m[38;5;15m,[39m
[38;5;15m    [39m[38;5;15mapply_query_key_layer_scaling[39m[38;5;197m=[39m[38;5;81mTrue[39m[38;5;15m,[39m
[38;5;15m)[39m
[38;5;15mmodel[39m[38;5;15m [39m[38;5;197m=[39m[38;5;15m [39m[38;5;15mLazyCall[39m[38;5;15m([39m[38;5;15mSeq2Seq[39m[38;5;15m)[39m[38;5;15m([39m[38;5;15mcfg[39m[38;5;197m=[39m[38;5;15mtransformer_cfg[39m[38;5;15m)[39m

[38;5;15mtrain[39m[38;5;197m.[39m[38;5;15mupdate[39m[38;5;15m([39m
[38;5;15m    [39m[38;5;15mdict[39m[38;5;15m([39m
[38;5;15m        [39m[38;5;15mrecompute_grad[39m[38;5;197m=[39m[38;5;15mdict[39m[38;5;15m([39m[38;5;15menabled[39m[38;5;197m=[39m[38;5;81mTrue[39m[38;5;15m)[39m[38;5;15m,[39m
[38;5;15m        [39m[38;5;15mamp[39m[38;5;197m=[39m[38;5;15mdict[39m[38;5;15m([39m[38;5;15menabled[39m[38;5;197m=[39m[38;5;81mTrue[39m[38;5;15m)[39m[38;5;15m,[39m
[38;5;15m        [39m[38;5;15moutput_dir[39m[38;5;197m=[39m[38;5;186m"[39m[38;5;186moutput/couplet/[39m[38;5;186m"[39m[38;5;15m,[39m
[38;5;15m        [39m[38;5;15mtrain_micro_batch_size[39m[38;5;197m=[39m[38;5;141m128[39m[38;5;15m,[39m
[38;5;15m        [39m[38;5;15mtest_micro_batch_size[39m[38;5;197m=[39m[38;5;141m32[39m[38;5;15m,[39m
[38;5;15m        [39m[38;5;15mtrain_epoch[39m[38;5;197m=[39m[38;5;141m20[39m[38;5;15m,[39m
[38;5;15m        [39m[38;5;15mtrain_iter[39m[38;5;197m=[39m[38;5;141m0[39m[38;5;15m,[39m
[38;5;15m        [39m[38;5;15meval_period[39m[38;5;197m=[39m[38;5;141m100[39m[38;5;15m,[39m
[38;5;15m        [39m[38;5;15mlog_period[39m[38;5;197m=[39m[38;5;141m10[39m[38;5;15m,[39m
[38;5;15m        [39m[38;5;15mwarmup_ratio[39m[38;5;197m=[39m[38;5;141m0.01[39m[38;5;15m,[39m
[38;5;15m        [39m[38;5;15mtopk[39m[38;5;197m=[39m[38;5;15m([39m[38;5;141m1[39m[38;5;15m,[39m[38;5;15m)[39m[38;5;15m,[39m
[38;5;15m        [39m[38;5;15mdist[39m[38;5;197m=[39m[38;5;15mdict[39m[38;5;15m([39m
[38;5;15m            [39m[38;5;15mdata_parallel_size[39m[38;5;197m=[39m[38;5;141m1[39m[38;5;15m,[39m
[38;5;15m            [39m[38;5;15mtensor_parallel_size[39m[38;5;197m=[39m[38;5;141m1[39m[38;5;15m,[39m
[38;5;15m            [39m[38;5;15mpipeline_parallel_size[39m[38;5;197m=[39m[38;5;141m1[39m[38;5;15m,[39m
[38;5;15m        [39m[38;5;15m)[39m[38;5;15m,[39m
[38;5;15m        [39m[38;5;15mevaluation[39m[38;5;197m=[39m[38;5;15mdict[39m[38;5;15m([39m
[38;5;15m            [39m[38;5;15menabled[39m[38;5;197m=[39m[38;5;81mFalse[39m[38;5;15m,[39m
[38;5;15m        [39m[38;5;15m)[39m
[38;5;15m    [39m[38;5;15m)[39m
[38;5;15m)[39m

[09/23 08:07:22] libai INFO: Full config saved to output/couplet/config.yaml
[09/23 08:07:22] lb.engine.default INFO: > compiling dataset index builder ...
[09/23 08:07:22] lb.engine.default INFO: >>> done with dataset index builder. Compilation time: 0.101 seconds
[09/23 08:07:22] lb.engine.default INFO: >>> done with compiling. Compilation time: 0.101 seconds
[09/23 08:07:22] lb.engine.default INFO: Prepare training, validating, testing set
